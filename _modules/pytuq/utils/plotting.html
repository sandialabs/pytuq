

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pytuq.utils.plotting &mdash; PyTUQ 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            PyTUQ
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/installation.html#install-from-source">Install from source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/about.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/about.html#authors">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/about.html#acknowledgements">Acknowledgements</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/index.html">Section Navigation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../autoapi/pytuq/index.html">pytuq</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/pytuq/index.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/fit/index.html">pytuq.fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/func/index.html">pytuq.func</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/gsa/index.html">pytuq.gsa</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/linred/index.html">pytuq.linred</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/lreg/index.html">pytuq.lreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/minf/index.html">pytuq.minf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/optim/index.html">pytuq.optim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/rv/index.html">pytuq.rv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/surrogates/index.html">pytuq.surrogates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/utils/index.html">pytuq.utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/pytuq/workflows/index.html">pytuq.workflows</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/indices.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PyTUQ</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pytuq.utils.plotting</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pytuq.utils.plotting</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;Module for various plotting functions.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ss</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">colorsys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.xutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_pdf</span><span class="p">,</span> <span class="n">sample_sphere</span><span class="p">,</span> <span class="n">pick_basis</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">strarr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.maps</span><span class="w"> </span><span class="kn">import</span> <span class="n">scale01ToDom</span>

<span class="c1">#############################################################</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>

<span class="c1">#############################################################</span>

<div class="viewcode-block" id="myrc">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.myrc">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">myrc</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configure matplotlib common look and feel.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Dictionary of matplotlib parameter config, not really used</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">max_open_warning</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="c1">#mpl.rc(&#39;lines&#39;, markeredgecolor=&#39;w&#39;)</span>
    <span class="c1"># mpl.rc(&#39;font&#39;, family=&#39;serif&#39;)</span>

    <span class="k">return</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="saveplot">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.saveplot">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">saveplot</span><span class="p">(</span><span class="n">figname</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save a figure with warnings ignored.</span>

<span class="sd">    Args:</span>
<span class="sd">        figname (mpl.Figure): Figure handle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="set_colors">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.set_colors">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">set_colors</span><span class="p">(</span><span class="n">npar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets a list of different colors of requested length, as rgb triples.</span>

<span class="sd">    Args:</span>
<span class="sd">        npar (int): Number of parameters.</span>
<span class="sd">    Returns:</span>
<span class="sd">        list[tuple]: List of rgb triples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pp</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">npar</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar</span><span class="p">):</span>
        <span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">/</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="n">pp</span><span class="p">)</span>
        <span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">3</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">b</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="o">==</span><span class="n">jj</span><span class="p">)</span>
        <span class="n">a</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]),(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>

    <span class="k">return</span> <span class="n">colors</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="lighten_color">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.lighten_color">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lighten_color</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lightens the given color by multiplying (1-luminosity) by the given amount.</span>
<span class="sd">    Input can be matplotlib color string, hex string, or RGB tuple.</span>

<span class="sd">    Args:</span>
<span class="sd">        color (str or tuple): Initial color.</span>
<span class="sd">        amount (float): How much to lighten: should be between 0 and 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: lightened color.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; lighten_color(&#39;g&#39;, 0.3)</span>
<span class="sd">        &gt;&gt;&gt; lighten_color(&#39;#F034A3&#39;, 0.6)</span>
<span class="sd">        &gt;&gt;&gt; lighten_color((.3,.55,.1), 0.5)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">cnames</span><span class="p">[</span><span class="n">color</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">color</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">colorsys</span><span class="o">.</span><span class="n">rgb_to_hls</span><span class="p">(</span><span class="o">*</span><span class="n">mc</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">colorsys</span><span class="o">.</span><span class="n">hls_to_rgb</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="o">-</span><span class="n">amount</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span></div>



<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_dm">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_dm">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_dm</span><span class="p">(</span><span class="n">datas</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">errorbars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="s1">&#39;Apprx&#39;</span><span class="p">],</span> <span class="n">figname</span><span class="o">=</span><span class="s1">&#39;dm.png&#39;</span><span class="p">,</span>
            <span class="n">legendpos</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">msize</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots data-vs-model and overlays `y=x`.</span>

<span class="sd">    Args:</span>
<span class="sd">        datas (list[np.ndarray]): List of `K` 1d data arrays.</span>
<span class="sd">        models (list[np.ndarray]): List of `K` 1d model arrays with matching sizes to data arrays.</span>
<span class="sd">        errorbars (list[(np.ndarray, np.ndarray)], optional): List of `K` (lower,upper) tuples as errorbars for each model array. Can be None.</span>
<span class="sd">        labels (list[str], optional): List of `K` labels. If None, the code uses something generic.</span>
<span class="sd">        colors (list[str], optional): List of `K` colors. If None, the code chooses internally.</span>
<span class="sd">        axes_labels (list[str], optional): List of two strings, x- and y-axis labels.</span>
<span class="sd">        figname (str, optional): Figure file name.</span>
<span class="sd">        legendpos (str, optional): Legend position, &#39;in&#39; or &#39;out&#39;</span>
<span class="sd">        msize (int, optional): Marker size.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">errorbars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">erb</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">erb</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">custom_xlabel</span> <span class="o">=</span> <span class="n">axes_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">custom_ylabel</span> <span class="o">=</span> <span class="n">axes_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">legendpos</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">legendpos</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>

    <span class="n">ncase</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">ncase</span>

    <span class="c1"># Create colors list</span>
    <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">set_colors</span><span class="p">(</span><span class="n">ncase</span><span class="p">)</span>

    <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncase</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">datas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">erb</span><span class="p">:</span>
            <span class="n">erbl</span><span class="p">,</span> <span class="n">erbh</span> <span class="o">=</span> <span class="n">errorbars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">npts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">neach</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">neach</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">ddata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">neach</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neach</span><span class="p">):</span>
            <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span> <span class="n">ddata</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">erb</span><span class="p">):</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">ddata</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">model</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="p">[</span><span class="n">erbl</span><span class="p">,</span> <span class="n">erbh</span><span class="p">],</span>
                             <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">msize</span><span class="p">,</span>
                             <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
                             <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                             <span class="n">ecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ddata</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">msize</span><span class="p">)</span>

    <span class="n">delt</span> <span class="o">=</span> <span class="mf">0.03</span> <span class="o">*</span> <span class="p">(</span><span class="n">yy</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">yy</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">minmax</span> <span class="o">=</span> <span class="p">[</span><span class="n">yy</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="n">delt</span><span class="p">,</span> <span class="n">yy</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="n">delt</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">minmax</span><span class="p">,</span> <span class="n">minmax</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">custom_xlabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">custom_ylabel</span><span class="p">)</span>
    <span class="c1"># plt.title(&#39;Data vs Model&#39;)</span>
    <span class="k">if</span> <span class="n">legendpos</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">legendpos</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                   <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="c1"># plt.xscale(&#39;log&#39;)</span>
    <span class="c1"># plt.yscale(&#39;log&#39;)</span>

    <span class="c1"># plt.gca().set_aspect(&#39;equal&#39;, adjustable=&#39;box&#39;)</span>
    <span class="c1"># plt.axis(&#39;scaled&#39;)</span>
    <span class="c1"># plt.axis(&#39;equal&#39;)</span>

    <span class="c1"># Trying to make sure both axis have the same number of ticks</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_xrv">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_xrv">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_xrv</span><span class="p">(</span><span class="n">xsam</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;xsam&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting samples one at a time, and one dimension vs the other.</span>

<span class="sd">    Args:</span>
<span class="sd">        xsam (np.ndarray): A `(N,d)` numpy array of samples</span>
<span class="sd">        prefix (str, optional): Prefix for filenames of the figures.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nsam</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">xsam</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xsam</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_d</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xsam</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">xsam</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_d</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_d</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="parallel_coordinates">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.parallel_coordinates">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">parallel_coordinates</span><span class="p">(</span><span class="n">parnames</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="s1">&#39;pcoord&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots parallel coordinates.</span>

<span class="sd">    Args:</span>
<span class="sd">        parnames (list[str]): list of `d` parameter names</span>
<span class="sd">        values (np.ndarray): `(d, N)` array of `N` data points with `d` parameters</span>
<span class="sd">        labels (list[str]): list of `N` labels/categories, one per point</span>
<span class="sd">        savefig (str, optional): figure name to save</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Start the figure</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.7</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="c1"># Categorize</span>
    <span class="n">ulabels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">n_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ulabels</span><span class="p">)</span>


    <span class="c1"># Plot</span>
    <span class="n">class_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">ulabels</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">values</span><span class="p">[:,:],</span> <span class="s1">&#39;go-&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">n_labels</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Set colors</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cmap</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_labels</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_labels</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
        <span class="k">for</span> <span class="n">c</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">class_id</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>


    <span class="c1"># Gridification</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;outward&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parnames</span><span class="p">)),</span> <span class="n">parnames</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

    <span class="n">leg_handlers</span> <span class="o">=</span> <span class="p">[</span> <span class="n">lines</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">class_id</span><span class="o">==</span><span class="nb">id</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_labels</span><span class="p">)]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">leg_handlers</span><span class="p">,</span> <span class="n">ulabels</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span>
                    <span class="n">ncol</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span>
                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c1"># Show or save</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_yx">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_yx">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_yx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rowcols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;eda.png&#39;</span><span class="p">,</span>
            <span class="n">xpad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">gridshow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots an output vs one input at a time in a matrix of figures.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.ndarray): An `(N,d)` input array.</span>
<span class="sd">        y (np.ndarray): An `(N,)` output array.</span>
<span class="sd">        rowcols (tuple[int], optional): A pair of integers, rows and columns.</span>
<span class="sd">        ylabel (str, optional): Y-axis label.</span>
<span class="sd">        xlabels (list[str], optional): List of X-axis labels.</span>
<span class="sd">        log (bool, optional): Whether to have log-`y` values or not.</span>
<span class="sd">        filename (str, optional): Figure filename to save.</span>
<span class="sd">        xpad (float, optional): Padding size between columns.</span>
<span class="sd">        ypad (float, optional): Padding size between rows.</span>
<span class="sd">        gridshow (bool, optional): Whether to show grid or not.</span>
<span class="sd">        ms (int, optional): Marker size.</span>
<span class="sd">        labelsize (int, optional): Axes label sizes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nsam</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">nsam</span><span class="o">==</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">rowcols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">(</span><span class="n">ndim</span> <span class="o">//</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">rowcols</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">cols</span><span class="p">,(</span><span class="mi">3</span><span class="o">+</span><span class="n">ypad</span><span class="p">)</span><span class="o">*</span><span class="n">rows</span><span class="p">),</span>
                             <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hspace&#39;</span><span class="p">:</span> <span class="n">ypad</span><span class="p">,</span> <span class="s1">&#39;wspace&#39;</span><span class="p">:</span> <span class="n">xpad</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">T</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">axes</span><span class="p">]])</span>

    <span class="k">if</span> <span class="n">xlabels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)]</span>
    <span class="c1">#print(axes.shape)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
        <span class="n">ih</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
        <span class="n">iv</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">ih</span><span class="p">,</span> <span class="n">iv</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">ih</span><span class="p">,</span> <span class="n">iv</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">ih</span><span class="p">,</span> <span class="n">iv</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
        <span class="c1">#axes[ih, iv].set_ylim(ymin=-0.05, ymax=0.5)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">ih</span><span class="p">,</span> <span class="n">iv</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">gridshow</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">ih</span><span class="p">,</span> <span class="n">iv</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span> <span class="n">cols</span><span class="o">*</span><span class="n">rows</span><span class="p">):</span>
        <span class="n">ih</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
        <span class="n">iv</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">ih</span><span class="p">,</span> <span class="n">iv</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div>



<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_sens">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_sens">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_sens</span><span class="p">(</span><span class="n">sensdata</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">cases</span><span class="p">,</span>
              <span class="n">vis</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">topsens</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">par_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">case_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">xlbl</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">grid_show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">legend_show</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">legend_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
              <span class="n">lbl_size</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
              <span class="n">xdatatick</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xticklabel_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xticklabel_rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">figname</span><span class="o">=</span><span class="s1">&#39;sens.png&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots sensitivities for multiple observables with respect to multiple parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        sensdata (np.ndarray): An array of sensitivities of size `(o,d)`.</span>
<span class="sd">        pars (list[int]): List of parameter indices to use. All should be less than `d`.</span>
<span class="sd">        cases (list[int]): List of output indices to use. All should be less than `o`.</span>
<span class="sd">        vis (str, optional): Plot type &#39;bar&#39; or &#39;graph&#39; (the latter is not used/tested often).</span>
<span class="sd">        reverse (bool, optional): Whether to flip the input data (i.e. parameters and outputs).</span>
<span class="sd">        topsens (int, optional): Show only some number of top parameters (default: show all).</span>
<span class="sd">        par_labels (list[str], optional): Parameter labels.</span>
<span class="sd">        case_labels (list[str], optional): Output labels.</span>
<span class="sd">        colors (None, optional): Parameter bar colors.</span>
<span class="sd">        xlbl (str, optional): X-label.</span>
<span class="sd">        title (str, optional): Title.</span>
<span class="sd">        grid_show (bool, optional): Whether to show the grid.</span>
<span class="sd">        legend_show (int, optional): Type of legend location, `1` is inside, `2` is below, `3` is above the graph.</span>
<span class="sd">        legend_size (int, optional): Legend fontsize.</span>
<span class="sd">        ncol (int, optional): Number of columns in legend.</span>
<span class="sd">        lbl_size (int, optional): Axes label size.</span>
<span class="sd">        yoffset (float, optional): Vertical offset, white space below the figure.</span>
<span class="sd">        xdatatick (list[float], optional): X-tick locations. By default, `1, ..., o`.</span>
<span class="sd">        xticklabel_size (int, optional): X-tick label size.</span>
<span class="sd">        xticklabel_rotation (int, optional): X-tick label rotation angle.</span>
<span class="sd">        figname (str, optional): Figure file name.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ncases</span><span class="o">=</span><span class="n">sensdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">npar</span><span class="o">=</span><span class="n">sensdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">wd</span><span class="o">=</span><span class="mf">0.6</span>
    <span class="n">ylbl</span><span class="o">=</span><span class="s1">&#39;Sensitivity&#39;</span>

    <span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">npar</span><span class="p">))</span>
    <span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">cases</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ncases</span><span class="p">))</span>

    <span class="c1"># Set up the figure</span>
    <span class="k">if</span> <span class="n">xticklabel_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xticklabel_size</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">400</span><span class="o">//</span><span class="n">ncases</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="o">+</span><span class="n">yoffset</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.6</span><span class="o">-</span><span class="n">yoffset</span><span class="p">])</span>

    <span class="c1"># Default parameter names</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">par_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">par_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;par_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar</span><span class="p">)]</span>

    <span class="c1"># Default case names</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">case_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">case_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;case_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncases</span><span class="p">)]</span>

    <span class="k">if</span><span class="p">(</span><span class="n">reverse</span><span class="p">):</span>
        <span class="n">par_labels</span><span class="p">,</span> <span class="n">case_labels</span> <span class="o">=</span> <span class="n">case_labels</span><span class="p">,</span> <span class="n">par_labels</span>
        <span class="n">pars</span><span class="p">,</span> <span class="n">cases</span> <span class="o">=</span> <span class="n">cases</span><span class="p">,</span> <span class="n">pars</span>
        <span class="n">sensdata</span><span class="o">=</span><span class="n">sensdata</span><span class="o">.</span><span class="n">T</span>

    <span class="n">npar_</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>
    <span class="n">ncases_</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)</span>

    <span class="n">sensind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">sensdata</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">topsens</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">topsens</span><span class="o">=</span><span class="n">npar_</span>

    <span class="c1"># Create colors list</span>
    <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors_</span> <span class="o">=</span> <span class="n">set_colors</span><span class="p">(</span><span class="n">topsens</span><span class="p">)</span>
        <span class="n">colors_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">set_colors</span><span class="p">(</span><span class="n">npar_</span><span class="o">-</span><span class="n">topsens</span><span class="p">))</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar_</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar_</span><span class="p">):</span>
            <span class="n">colors</span><span class="p">[</span><span class="n">sensind</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">colors_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">case_labels_</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncases_</span><span class="p">):</span>
        <span class="n">case_labels_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">case_labels</span><span class="p">[</span><span class="n">cases</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

    <span class="k">if</span> <span class="n">xdatatick</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xflag</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">xdatatick</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncases_</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">sc</span><span class="o">=</span><span class="mf">1.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">xflag</span><span class="o">=</span><span class="kc">True</span>
        <span class="n">sc</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">xdatatick</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xdatatick</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">ncases_</span>


    <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="o">==</span><span class="s2">&quot;graph&quot;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar_</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdatatick</span><span class="p">,</span><span class="n">sensdata</span><span class="p">[</span><span class="n">cases</span><span class="p">,</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">pars</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="n">par_labels</span><span class="p">[</span><span class="n">pars</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">vis</span><span class="o">==</span><span class="s2">&quot;bar&quot;</span><span class="p">):</span>
        <span class="n">curr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ncases_</span><span class="p">))</span>
        <span class="c1">#print pars,colors</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar_</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xdatatick</span><span class="p">,</span> <span class="n">sensdata</span><span class="p">[</span><span class="n">cases</span><span class="p">,</span><span class="n">i</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">wd</span><span class="o">*</span><span class="n">sc</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">pars</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">bottom</span><span class="o">=</span><span class="n">curr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">par_labels</span><span class="p">[</span><span class="n">pars</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">curr</span><span class="o">=</span><span class="n">sensdata</span><span class="p">[</span><span class="n">cases</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">curr</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">xflag</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncases_</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">case_labels_</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="n">xticklabel_rotation</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">xticklabel_size</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xdatatick</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">wd</span><span class="o">*</span><span class="n">sc</span><span class="o">/</span><span class="mf">2.</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">xdatatick</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">wd</span><span class="o">*</span><span class="n">sc</span><span class="o">/</span><span class="mf">2.</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylbl</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">lbl_size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlbl</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">lbl_size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">maxsens</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">curr</span><span class="p">),</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">maxsens</span><span class="p">])</span>
    <span class="n">handles</span><span class="p">,</span><span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">handles</span> <span class="o">=</span> <span class="p">[</span> <span class="n">handles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sensind</span><span class="p">[:</span><span class="n">topsens</span><span class="p">]]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sensind</span><span class="p">[:</span><span class="n">topsens</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">legend_show</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">legend_size</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">legend_show</span><span class="o">==</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">),</span><span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="n">ncol</span><span class="p">,</span><span class="n">labelspacing</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">legend_size</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">legend_show</span><span class="o">==</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span><span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="n">ncol</span><span class="p">,</span><span class="n">labelspacing</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">legend_size</span><span class="p">)</span>


    <span class="c1"># if not xflag:</span>
    <span class="c1">#     print(dir(plt.gca().xaxis.get_major_ticks()[0]))</span>
    <span class="c1">#     zed = [tick.label.set_fontsize(xticklabel_size) for tick in plt.gca().xaxis.get_major_ticks()]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid_show</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>



<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_jsens">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_jsens">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_jsens</span><span class="p">(</span><span class="n">msens</span><span class="p">,</span><span class="n">jsens</span><span class="p">,</span><span class="n">varname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inpar_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">figname</span><span class="o">=</span><span class="s1">&#39;senscirc.png&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting circular joint sensitivities.</span>

<span class="sd">    Args:</span>
<span class="sd">        msens (np.ndarray): Main sensitivities, a 1d array.</span>
<span class="sd">        jsens (np.ndarray): Joint sensitivities. A 2d square array.</span>
<span class="sd">        varname (str, optional): Variable name.</span>
<span class="sd">        inpar_names (list, optional): List of names for input parameters. Defaults to something generic.</span>
<span class="sd">        figname (str, optional): Saving figure file name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Nmain</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">msens</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">Nsec</span><span class="o">=</span><span class="n">Nmain</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">lwMax</span><span class="o">=</span><span class="mi">10</span>
    <span class="n">lwCut</span><span class="o">=</span><span class="mf">0.2</span>
    <span class="n">radMain</span><span class="o">=</span><span class="mi">50</span>
    <span class="n">radOut</span><span class="o">=</span><span class="mi">15</span>
    <span class="n">lext</span><span class="o">=</span><span class="mf">0.4</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>

    <span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">jsens</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1"># assert nx=ny? compare with msens shape?</span>

    <span class="k">if</span> <span class="n">inpar_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">inpar_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Par</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">)]</span>


    <span class="c1">#jsens=np.log10(jsens);</span>
    <span class="c1">#print msens</span>
    <span class="n">ind</span><span class="o">=</span><span class="n">msens</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">msensShort</span><span class="o">=</span><span class="n">msens</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">Nmain</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nmain</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input </span><span class="si">%d</span><span class="s2">, main sensitivity </span><span class="si">%lg</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">msens</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="c1">#circ=pylab.Circle((0,0),radius=0.5,color=&#39;r&#39;)</span>
    <span class="n">circ</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Wedge</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">),</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
    <span class="n">maxJfr</span><span class="o">=-</span><span class="mf">1.e10</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nmain</span><span class="p">):</span>
        <span class="n">jfr_i</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nx</span><span class="p">))</span>
        <span class="n">iord</span><span class="o">=</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iord</span><span class="p">):</span>
            <span class="n">jfr_i</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">jsens</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">iord</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iord</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nx</span><span class="p">):</span>
            <span class="n">jfr_i</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">jsens</span><span class="p">[</span><span class="n">iord</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ind_j</span><span class="o">=</span><span class="n">jfr_i</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
        <span class="k">if</span> <span class="n">jfr_i</span><span class="p">[</span><span class="n">ind_j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">maxJfr</span><span class="p">:</span> <span class="n">maxJfr</span> <span class="o">=</span> <span class="n">jfr_i</span><span class="p">[</span><span class="n">ind_j</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nsec</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">  </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">iord</span><span class="p">,</span><span class="n">ind_j</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">jfr_i</span><span class="p">[</span><span class="n">ind_j</span><span class="p">[</span><span class="n">j</span><span class="p">]]))</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum joint sensitivity </span><span class="si">%lg</span><span class="s2">:&quot;</span> <span class="o">%</span> <span class="n">maxJfr</span><span class="p">)</span>
    <span class="n">gopar</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nmain</span><span class="p">):</span>
        <span class="n">jfr_i</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nx</span><span class="p">))</span>
        <span class="n">iord</span><span class="o">=</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iord</span><span class="p">):</span>
            <span class="n">jfr_i</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">jsens</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">iord</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iord</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nx</span><span class="p">):</span>
            <span class="n">jfr_i</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">jsens</span><span class="p">[</span><span class="n">iord</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ind_j</span><span class="o">=</span><span class="n">jfr_i</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
        <span class="n">elst</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nsec</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">maxJfr</span><span class="o">&gt;</span><span class="mf">1.e-16</span> <span class="ow">and</span> <span class="n">jfr_i</span><span class="p">[</span><span class="n">ind_j</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">/</span><span class="n">maxJfr</span> <span class="o">&gt;=</span> <span class="n">lwCut</span><span class="p">:</span>
                <span class="n">posj</span><span class="o">=</span><span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ind</span><span class="p">[:</span><span class="n">Nmain</span><span class="p">])</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">ind_j</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">posj</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">posj</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
                    <span class="n">x1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">posj</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">Nmain</span><span class="p">)</span>
                    <span class="n">x2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span>      <span class="p">)</span><span class="o">/</span><span class="n">Nmain</span><span class="p">)</span>
                    <span class="n">y1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">posj</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">Nmain</span><span class="p">)</span>
                    <span class="n">y2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span>      <span class="p">)</span><span class="o">/</span><span class="n">Nmain</span><span class="p">)</span>
                    <span class="n">lw</span><span class="o">=</span><span class="n">lwMax</span><span class="o">*</span><span class="n">jfr_i</span><span class="p">[</span><span class="n">ind_j</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">/</span><span class="n">maxJfr</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">],[</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">],</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">iord</span><span class="p">,</span><span class="n">ind</span><span class="p">[</span><span class="n">posj</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">elst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elst</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">asft</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elst</span><span class="p">),</span><span class="mi">3</span><span class="p">)):</span>
                <span class="n">ang</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">Nmain</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">12</span><span class="o">*</span><span class="n">asft</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">x2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">Nmain</span><span class="p">)</span>
                <span class="n">y2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">Nmain</span><span class="p">)</span>
                <span class="n">x1</span><span class="o">=</span><span class="n">x2</span><span class="o">+</span><span class="n">lext</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
                <span class="n">y1</span><span class="o">=</span><span class="n">y2</span><span class="o">+</span><span class="n">lext</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
                <span class="n">lw</span><span class="o">=</span><span class="n">lwMax</span><span class="o">*</span><span class="n">jfr_i</span><span class="p">[</span><span class="n">ind_j</span><span class="p">[</span><span class="n">elst</span><span class="p">[</span><span class="n">k</span><span class="p">]]]</span><span class="o">/</span><span class="n">maxJfr</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">],[</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">],</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">],[</span><span class="n">y1</span><span class="p">],</span><span class="s2">&quot;wo&quot;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="n">radOut</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                         <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">ind_j</span><span class="p">[</span><span class="n">elst</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mi">32</span> <span class="p">):</span>
                    <span class="n">ltext</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">ind_j</span><span class="p">[</span><span class="n">elst</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">elif</span> <span class="p">(</span> <span class="n">ind_j</span><span class="p">[</span><span class="n">elst</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mi">30</span> <span class="p">):</span>
                    <span class="n">ltext</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">ind_j</span><span class="p">[</span><span class="n">elst</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ltext</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">ind_j</span><span class="p">[</span><span class="n">elst</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="p">(</span><span class="mf">0.15</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang</span><span class="p">),</span><span class="n">y1</span><span class="o">+</span><span class="p">(</span><span class="mf">0.15</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang</span><span class="p">),</span><span class="n">ltext</span><span class="p">,</span>
                            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
                <span class="n">posj</span><span class="o">=</span><span class="p">[</span><span class="n">k1</span> <span class="k">for</span> <span class="n">k1</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gopar</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">ind_j</span><span class="p">[</span><span class="n">elst</span><span class="p">[</span><span class="n">k</span><span class="p">]]]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">posj</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">gopar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind_j</span><span class="p">[</span><span class="n">elst</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nmain</span><span class="p">):</span>
        <span class="n">angl</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">Nmain</span>
        <span class="n">xc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angl</span><span class="p">);</span>
        <span class="n">yc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angl</span><span class="p">);</span>
        <span class="n">msize</span><span class="o">=</span><span class="n">radMain</span><span class="o">*</span><span class="n">msens</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">/</span><span class="n">msens</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xc</span><span class="p">],[</span><span class="n">yc</span><span class="p">],</span><span class="s2">&quot;bo&quot;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="n">msize</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">da</span><span class="o">=</span><span class="mf">1.0</span>
        <span class="n">lab</span><span class="o">=</span><span class="mf">0.2</span>
        <span class="n">llab</span><span class="o">=</span><span class="n">lab</span><span class="o">*</span><span class="n">msens</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">/</span><span class="n">msens</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="n">ltext</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lleg</span><span class="o">=</span><span class="n">ltext</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="n">inpar_names</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xc</span><span class="o">+</span><span class="p">(</span><span class="mf">0.08</span><span class="o">+</span><span class="n">llab</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angl</span><span class="o">+</span><span class="n">da</span><span class="p">),</span><span class="n">yc</span><span class="o">+</span><span class="p">(</span><span class="mf">0.08</span><span class="o">+</span><span class="n">llab</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angl</span><span class="o">+</span><span class="n">da</span><span class="p">),</span><span class="n">ltext</span><span class="p">,</span>
                 <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.6</span><span class="p">,</span><span class="mf">1.2</span><span class="o">-</span><span class="mf">0.15</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">lleg</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gopar</span><span class="p">)):</span>
        <span class="n">lleg</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">gopar</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="n">inpar_names</span><span class="p">[</span><span class="n">gopar</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.6</span><span class="p">,</span><span class="mf">1.2</span><span class="o">-</span><span class="mf">0.15</span><span class="o">*</span><span class="n">Nmain</span><span class="o">-</span><span class="mf">0.15</span><span class="o">*</span><span class="n">k</span><span class="p">,</span><span class="n">lleg</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mf">1.6</span><span class="o">*</span><span class="n">lext</span><span class="p">,</span><span class="mf">1.8</span><span class="o">+</span><span class="mf">1.6</span><span class="o">*</span><span class="n">lext</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mf">1.6</span><span class="o">*</span><span class="n">lext</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mf">1.6</span><span class="o">*</span><span class="n">lext</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_tri">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_tri">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_tri</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">msize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figname</span><span class="o">=</span><span class="s1">&#39;xsam_tri.png&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots multidimensional samples in a triangular way, i.e. 1d and 2d cuts.</span>

<span class="sd">    Args:</span>
<span class="sd">        xi (np.ndarray): `(N,d)` array to plot.</span>
<span class="sd">        names (list[str], optional): List of `d` names.</span>
<span class="sd">        msize (int, optional): Markersize of the 2d plots.</span>
<span class="sd">        figname (str, optional): Figure file name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nsam</span><span class="p">,</span> <span class="n">npar</span> <span class="o">=</span> <span class="n">xi</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">figs</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">npar</span><span class="p">,</span> <span class="n">npar</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">npar</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="n">axarr</span><span class="o">=</span><span class="p">[[</span><span class="n">axarr</span><span class="p">]]</span>

    <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar</span><span class="p">)]</span>
    <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="o">==</span><span class="n">npar</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar</span><span class="p">):</span>
        <span class="n">thisax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="n">thisax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nsam</span><span class="p">),</span> <span class="n">xi</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">thisax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">npar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">thisax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">thisax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
        <span class="c1"># thisax.yaxis.set_label_coords(-0.12, 0.5)</span>


        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
            <span class="n">thisax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">axarr</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

            <span class="n">thisax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xi</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">xi</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">msize</span><span class="p">)</span>


            <span class="c1"># x0, x1 = thisax.get_xlim()</span>
            <span class="c1"># y0, y1 = thisax.get_ylim()</span>
            <span class="c1"># #thisax.set_aspect((x1 - x0) / (y1 - y0))</span>

            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">thisax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">npar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">thisax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">thisax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_pdf1d">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_pdf1d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_pdf1d</span><span class="p">(</span><span class="n">sams</span><span class="p">,</span> <span class="n">pltype</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
               <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nom_height_factor</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">histalpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting 1d PDFs of samples.</span>

<span class="sd">    Args:</span>
<span class="sd">        sams (np.ndarray): The `(N,)` samples of interest.</span>
<span class="sd">        pltype (str, optional): Plot type. Options are &#39;kde&#39; (Kernel Density Estimation), &#39;hist&#39; (Histogram), &#39;sam&#39; (plot samples as dots on x-axis), &#39;nom&#39; (plot a nominal vertical line)</span>
<span class="sd">        color (str, optional): Color.</span>
<span class="sd">        lw (float, optional): Line width, when relevant.</span>
<span class="sd">        nom_height_factor (float, optional): Controls the height of the nominal vertical bar.</span>
<span class="sd">        histalpha (float, optional): Opacity of histogram, between `0` and `1`.</span>
<span class="sd">        label (str, optional): Label for legend.</span>
<span class="sd">        ax (plt.Axes, optional): Axis handle. If None, use the current axis.</span>
<span class="sd">    Note:</span>
<span class="sd">        ax is changed as a result of this function. Further beautification and figure saving should be done outside this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">pltype</span> <span class="o">==</span> <span class="s1">&#39;kde&#39;</span><span class="p">:</span>
        <span class="n">ngrid</span> <span class="o">=</span> <span class="mi">111</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mf">3.</span>
        <span class="n">pnom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sams</span><span class="p">)</span>
        <span class="n">pdel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sams</span><span class="p">)</span>
        <span class="n">pgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pnom</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">pdel</span><span class="p">,</span> <span class="n">pnom</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">pdel</span><span class="p">,</span> <span class="n">ngrid</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">sams</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">):</span>
            <span class="n">pdf</span> <span class="o">=</span> <span class="n">get_pdf</span><span class="p">(</span><span class="n">sams</span><span class="p">,</span> <span class="n">pgrid</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pgrid</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sams</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sams</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span> <span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pltype</span> <span class="o">==</span> <span class="s1">&#39;hist&#39;</span><span class="p">:</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">sams</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                   <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">histalpha</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pltype</span> <span class="o">==</span> <span class="s1">&#39;sam&#39;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sams</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sams</span><span class="p">),</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pltype</span> <span class="o">==</span> <span class="s1">&#39;nom&#39;</span><span class="p">:</span>
        <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">y2f</span> <span class="o">=</span> <span class="n">nom_height_factor</span>
        <span class="k">for</span> <span class="n">sam</span> <span class="ow">in</span> <span class="n">sams</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sam</span><span class="p">,</span> <span class="n">sam</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">/</span> <span class="n">y2f</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plot type is not recognized. Exiting&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="c1">#ax.set_ylim(bottom=0)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>



<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_pdf2d">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_pdf2d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_pdf2d</span><span class="p">(</span><span class="n">samsx</span><span class="p">,</span> <span class="n">samsy</span><span class="p">,</span> <span class="n">pltype</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="n">ncont</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
               <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lwidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">mstyle</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot 2d contour plot of a PDF given two sets of samples.</span>

<span class="sd">    Args:</span>
<span class="sd">        samsx (np.ndarray): First `(N,)` samples of interest.</span>
<span class="sd">        samsy (np.ndarray): Second `(N,)` samples of interest.</span>
<span class="sd">        pltype (str, optional): Plot type. Options are Options are &#39;kde&#39; (Kernel Density Estimation), &#39;sam&#39; (plot samples only).</span>
<span class="sd">        ncont (int, optional): Number of contours.</span>
<span class="sd">        color (str, optional): Color. If None, uses the multicolor default of matplotlib.</span>
<span class="sd">        lwidth (float, optional): Line width.</span>
<span class="sd">        mstyle (str, optional): Marker stile.</span>
<span class="sd">        ax (plt.Axes, optional): Axis handle. If None, use the current axis.</span>
<span class="sd">    Note:</span>
<span class="sd">        ax is changed as a result of this function. Further beautification and figure saving should be done outside this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">pltype</span> <span class="o">==</span> <span class="s1">&#39;kde&#39;</span><span class="p">:</span>
        <span class="n">ngrid</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mf">3.</span>
        <span class="n">pnomx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samsx</span><span class="p">)</span>
        <span class="n">pdelx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">samsx</span><span class="p">)</span>
        <span class="n">pnomy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samsy</span><span class="p">)</span>
        <span class="n">pdely</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">samsy</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pnomx</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">pdelx</span><span class="p">,</span> <span class="n">pnomx</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">pdelx</span><span class="p">,</span> <span class="n">ngrid</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pnomy</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">pdely</span><span class="p">,</span> <span class="n">pnomy</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">pdely</span><span class="p">,</span> <span class="n">ngrid</span><span class="p">)</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">pgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">Y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># pgrid.shape is (33^2,2)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">samsx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">samsy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">):</span>
            <span class="n">pdf</span> <span class="o">=</span> <span class="n">get_pdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">samsx</span><span class="p">,</span> <span class="n">samsy</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">pgrid</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">pdf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">ncont</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="n">lwidth</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">pdf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">ncont</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="n">lwidth</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipping 2d PDF due to degeneracy&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">pltype</span> <span class="o">==</span> <span class="s1">&#39;sam&#39;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samsx</span><span class="p">,</span> <span class="n">samsy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">mstyle</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plot type is not recognized. Exiting&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>



<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_pdfs">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_pdfs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_pdfs</span><span class="p">(</span><span class="n">ind_show</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;tri&#39;</span><span class="p">,</span> <span class="n">pdf_type</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span>
              <span class="n">samples_</span><span class="o">=</span><span class="s1">&#39;chain.txt&#39;</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
              <span class="n">names_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nominal_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prange_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">show_2dsamples</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">lsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">zsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computing and plotting set of 1d and/or 2d PDFs given a sample set.</span>

<span class="sd">    Args:</span>
<span class="sd">        ind_show (list[int], optional): Indices of dimensions (columns of samples) to show.</span>
<span class="sd">        plot_type (str, optional): Plot type. Options are &#39;tri&#39; (trianguar plot of 1d/2d marginals), &#39;inds&#39; (1d marginals in a single figure), &#39;ind&#39; (individual files for 1d and 2d marginal PDFs)</span>
<span class="sd">        pdf_type (str, optional): 1d PDF type. Options are &#39;hist&#39; (histogram) or &#39;kde&#39; (Kernel Density Estimation)</span>
<span class="sd">        samples_ (str or np.ndarray, optional): Filename or `(N,d)` numpy array of samples.</span>
<span class="sd">        burnin (int, optional): Number of samples to throw away from the beginning of samples.</span>
<span class="sd">        every (int, optional): Stratification: use every `k`-th sample.</span>
<span class="sd">        names_ (str or list[str], optional): Filename containing the names of dimensions or list of names. Default is None, that leads to generic names.</span>
<span class="sd">        nominal_ (str or np.ndarray, optional): Filename or `(d,)` numpy array of nominals to be shown as vertical bars on top of 1d PDFs, and dots on top of 2d PDFs.</span>
<span class="sd">        prange_ (str or np.ndarray, optional): Filename or `(d,2)` numpy array of dimensional ranges to be shown as &#39;box&#39; priors.</span>
<span class="sd">        show_2dsamples (bool, optional): Whether or not to display the samples on top of 2d contour plots.</span>
<span class="sd">        lsize (int or float, optional): Title size and X- and Y- label size.</span>
<span class="sd">        zsize (int or float, optional): X- and Y- tick label size.</span>
<span class="sd">        xpad (float, optional): Horizontal padding for multiplot figures (&#39;tri&#39; and &#39;inds&#39;).</span>
<span class="sd">        ypad (float, optional): Vertical padding for multiplot figures (&#39;tri&#39; and &#39;inds&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Figure and axes array handles for further edits if needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">samples_</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">samples_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">samples_</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">samples_all</span> <span class="o">=</span> <span class="n">samples_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">npar_all</span> <span class="o">=</span> <span class="n">samples_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">ind_show</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ind_show</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar_all</span><span class="p">)</span>

    <span class="n">samples</span> <span class="o">=</span> <span class="n">samples_all</span><span class="p">[</span><span class="n">burnin</span><span class="p">::</span><span class="n">every</span><span class="p">,</span> <span class="n">ind_show</span><span class="p">]</span>
    <span class="n">npar</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_show</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">names_</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">names_</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">names_</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">names</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
                <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="n">npar_all</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">names_</span><span class="si">}</span><span class="s2"> does not exist. Exiting&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">names_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;p&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar_all</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">names_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">nominal_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nominal_</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">nominal_</span><span class="p">):</span>
                <span class="n">nominals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">nominal_</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">nominal_</span><span class="si">}</span><span class="s2"> does not exist. Exiting&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nominals</span> <span class="o">=</span> <span class="n">nominal_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">show_range</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">prange_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">show_range</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prange_</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">prange_</span><span class="p">):</span>
                <span class="n">prange</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">prange_</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">prange_</span><span class="si">}</span><span class="s2"> does not exist. Exiting&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prange</span> <span class="o">=</span> <span class="n">prange_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;tri&#39;</span><span class="p">:</span>
        <span class="n">figs</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">npar</span><span class="p">,</span> <span class="n">npar</span><span class="p">,</span>
                                   <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">npar</span><span class="p">,(</span><span class="mi">5</span><span class="o">+</span><span class="n">ypad</span><span class="p">)</span><span class="o">*</span><span class="n">npar</span><span class="p">),</span>
                                   <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hspace&#39;</span><span class="p">:</span> <span class="n">ypad</span><span class="p">,</span> <span class="s1">&#39;wspace&#39;</span><span class="p">:</span> <span class="n">xpad</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">npar</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="n">axarr</span><span class="o">=</span><span class="p">[[</span><span class="n">axarr</span><span class="p">]]</span>

    <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;inds&#39;</span><span class="p">:</span>
        <span class="n">ncol</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">npar</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">nrow</span> <span class="o">=</span> <span class="p">(</span><span class="n">npar</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">ncol</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">figs</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span>
                                   <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">ncol</span><span class="p">,(</span><span class="mi">5</span><span class="o">+</span><span class="n">ypad</span><span class="p">)</span><span class="o">*</span><span class="n">nrow</span><span class="p">),</span>
                                   <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hspace&#39;</span><span class="p">:</span> <span class="n">ypad</span><span class="p">,</span> <span class="s1">&#39;wspace&#39;</span><span class="p">:</span> <span class="n">xpad</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">nrow</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="n">axarr</span><span class="o">=</span><span class="p">[</span><span class="n">axarr</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ncol</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="n">axarr</span><span class="o">=</span><span class="p">[</span><span class="n">axarr</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar</span><span class="p">,</span> <span class="n">ncol</span><span class="o">*</span><span class="n">nrow</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">ncol</span>
            <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">//</span><span class="n">ncol</span>
            <span class="n">axarr</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;ind&#39;</span><span class="p">:</span>
        <span class="n">axarr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plot type </span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> is not recognized. Exiting.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quantity # &quot;</span><span class="p">,</span> <span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;; Name : &quot;</span><span class="p">,</span> <span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;tri&#39;</span><span class="p">:</span>
            <span class="n">thisax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;inds&#39;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">ncol</span>
            <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">//</span><span class="n">ncol</span>
            <span class="n">thisax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>


        <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;ind&#39;</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">thisax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
            <span class="n">axarr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisax</span><span class="p">)</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="n">plot_pdf1d</span><span class="p">(</span><span class="n">samples</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">pltype</span><span class="o">=</span><span class="n">pdf_type</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">thisax</span><span class="p">)</span>
        <span class="n">thisax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nominal_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_pdf1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nominals</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">pltype</span><span class="o">=</span><span class="s1">&#39;nom&#39;</span><span class="p">,</span>
                       <span class="n">nom_height_factor</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">thisax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_range</span><span class="p">:</span>
            <span class="n">dr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prange</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">prange</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">thisax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">prange</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="n">prange</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span>
                         <span class="n">prange</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">],</span> <span class="n">prange</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">]],</span>
                        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dr</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dr</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prior&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">thisax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">thisax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="c1"># thisax.set_aspect((x1 - x0) / (y1 - y0))</span>
        <span class="n">thisax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PDF of &#39;</span> <span class="o">+</span> <span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">lsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;tri&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">thisax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="n">lsize</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">npar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">thisax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="n">lsize</span><span class="p">)</span>
                <span class="n">thisax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">zsize</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">thisax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

            <span class="n">thisax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">zsize</span><span class="p">)</span>
            <span class="c1"># thisax.yaxis.set_label_coords(-0.12, 0.5)</span>
        <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;inds&#39;</span><span class="p">:</span>
            <span class="n">thisax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="n">lsize</span><span class="p">)</span>
            <span class="n">thisax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">zsize</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;ind&#39;</span><span class="p">:</span>
            <span class="n">thisax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="n">lsize</span><span class="p">)</span>
            <span class="n">thisax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">zsize</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;pdf_&#39;</span> <span class="o">+</span> <span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">)</span>
            <span class="c1"># plt.clf()</span>

        <span class="c1"># Plot 2d contours</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;tri&#39;</span><span class="p">:</span>
                <span class="n">thisax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                <span class="n">axarr</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;ind&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
                <span class="n">thisax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;inds&#39;</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="n">plot_pdf2d</span><span class="p">(</span><span class="n">samples</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">samples</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span>
                       <span class="n">pltype</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ncont</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">lwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">thisax</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_2dsamples</span><span class="p">:</span>
                <span class="n">thisax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">samples</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1000</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">nominal_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plot_pdf2d</span><span class="p">(</span><span class="n">nominals</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">nominals</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                           <span class="n">pltype</span><span class="o">=</span><span class="s1">&#39;sam&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">mstyle</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">thisax</span><span class="p">)</span>

            <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">thisax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
            <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">thisax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="c1">#thisax.set_aspect((x1 - x0) / (y1 - y0))</span>

            <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;tri&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">thisax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="n">lsize</span><span class="p">)</span>
                    <span class="n">thisax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">zsize</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">npar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">thisax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="n">lsize</span><span class="p">)</span>
                    <span class="n">thisax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">zsize</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;ind&#39;</span><span class="p">:</span>
                <span class="n">thisax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="n">lsize</span><span class="p">)</span>
                <span class="n">thisax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="n">lsize</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;pdf_&#39;</span> <span class="o">+</span> <span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">names</span><span class="p">[</span><span class="n">ind_show</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">)</span>
                <span class="c1"># plt.clf()</span>


    <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;tri&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;pdf_tri.png&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;inds&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;pdf_inds.png&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">figs</span><span class="p">,</span> <span class="n">axarr</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_ens">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_ens">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_ens</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">grid_show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
             <span class="n">connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting an ensemble of `y` values versus input `x`.</span>

<span class="sd">    Args:</span>
<span class="sd">        xdata (np.ndarray): Input values, an 1d array of size `(N,)`.</span>
<span class="sd">        ydata (np.ndarray): Output values, a 2d array of size `(N,M)`.</span>
<span class="sd">        color (str, optional): Plot color.</span>
<span class="sd">        lw (int or float, optional): Linewidth.</span>
<span class="sd">        ms (int or float, optional): Markersize.</span>
<span class="sd">        grid_show (bool, optional): Whether to show the grid or not.</span>
<span class="sd">        label (str, optional): Label for legends down the road.</span>
<span class="sd">        mec (str, optional): Marker edge color</span>
<span class="sd">        connected (bool, optional): Whether to connect the data dots or not.</span>
<span class="sd">        interp (bool, optional): Whether to have smooth interpolation or not.</span>
<span class="sd">        offset (tuple, optional): Tuple of (shift, scale) to preprocess y-data, if needed, both shift and scale are either None or 1d arrays of size `(d,)`.</span>
<span class="sd">        ax (plt.Axes, optional): Axis handle. If None, use the current axis.</span>
<span class="sd">    Note:</span>
<span class="sd">        ax is changed as a result of this function. Further beautification and figure saving should be done outside this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="n">nx</span> <span class="o">=</span> <span class="n">ydata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">nsam</span> <span class="o">=</span> <span class="n">ydata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">shift</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">offset</span>
    <span class="k">if</span> <span class="n">shift</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


    <span class="n">ydata_</span> <span class="o">=</span> <span class="p">(</span><span class="n">ydata</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span>

    <span class="k">if</span> <span class="n">interp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">connected</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">xdel</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span>
        <span class="n">ngr</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">xdata_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">xdel</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">+</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">xdel</span><span class="p">,</span> <span class="n">ngr</span><span class="p">)</span>

        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">ngr</span><span class="p">,</span> <span class="n">nsam</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsam</span><span class="p">):</span>
            <span class="n">interp_fcn</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="n">interp</span><span class="p">)</span>
            <span class="n">tmp</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp_fcn</span><span class="p">(</span><span class="n">xdata_</span><span class="p">)</span>
        <span class="n">ydata_</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">xdata_</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">connected</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsam</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata_</span><span class="p">,</span> <span class="n">ydata_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span>
                       <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsam</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata_</span><span class="p">,</span> <span class="n">ydata_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                       <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                       <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="n">mec</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">ms</span><span class="p">,</span>
                       <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid_show</span><span class="p">)</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_vars">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_vars">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_vars</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">variances</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ysam</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdfactor</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
              <span class="n">varlabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">varcolors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grid_show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting mean predictions with multicolor variances as error bars.</span>

<span class="sd">    Args:</span>
<span class="sd">        xdata (np.ndarray): Input values, an 1d array of size `(N,)`.</span>
<span class="sd">        ydata (np.ndarray): Output values, a 1d array of size `(N,)`.</span>
<span class="sd">        variances (None, optional): Variances, a 2d array of size `(N,K)`.</span>
<span class="sd">        ysam (None, optional): True samples, a 2d array of size `(N,M)`.</span>
<span class="sd">        stdfactor (float, optional): Factor in front of st.dev. for plotting (e.g. `1.0` or `3.0`).</span>
<span class="sd">        varlabels (list[str], optional): List of `K` labels for each variance. If None, the code comes up with generic names.</span>
<span class="sd">        varcolors (list[str], optional): List of `K` variance colors. If None, the code uses shades of grey (not fifty).</span>
<span class="sd">        grid_show (bool, optional): Whether or not to show the grid.</span>
<span class="sd">        connected (bool, optional): Whether to connect the data dots or not.</span>
<span class="sd">        interp (bool, optional): Whether to have smooth interpolation or not.</span>
<span class="sd">        offset (tuple, optional): Tuple of (shift, scale) to preprocess y-data, if needed, both shift and scale are either None or 1d arrays of size `(d,)`.</span>
<span class="sd">        ax (plt.Axes, optional): Axis handle. If None, use the current axis.</span>
<span class="sd">    Note:</span>
<span class="sd">        ax is changed as a result of this function. Further beautification and figure saving should be done outside this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">varcolors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Greys</span>

    <span class="k">if</span> <span class="n">ysam</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plot_ens</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ysam</span><span class="p">,</span>
                 <span class="n">connected</span><span class="o">=</span><span class="n">connected</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="n">interp</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="n">shift</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">offset</span>
    <span class="k">if</span> <span class="n">shift</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>

    <span class="n">ydata_</span> <span class="o">=</span> <span class="p">(</span><span class="n">ydata</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span>


    <span class="k">if</span> <span class="n">variances</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">variances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">variances</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">variances</span> <span class="o">=</span> <span class="n">variances</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">variances_</span> <span class="o">=</span> <span class="n">variances</span> <span class="o">/</span> <span class="p">(</span><span class="n">scale</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">nvariances</span> <span class="o">=</span> <span class="n">variances_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">interp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">connected</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">xdel</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span>
        <span class="n">ngr</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">xdata_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">xdel</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">+</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">xdel</span><span class="p">,</span> <span class="n">ngr</span><span class="p">)</span>

        <span class="n">interp_fcn</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata_</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">interp</span><span class="p">)</span>
        <span class="n">ydata_</span> <span class="o">=</span> <span class="n">interp_fcn</span><span class="p">(</span><span class="n">xdata_</span><span class="p">)</span>

        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ngr</span><span class="p">,</span> <span class="n">nvariances</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvariances</span><span class="p">):</span>
            <span class="n">interp_fcn</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">variances_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="n">interp</span><span class="p">)</span>
            <span class="n">tmp</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp_fcn</span><span class="p">(</span><span class="n">xdata_</span><span class="p">)</span>
        <span class="n">variances_</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">xdata_</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">cvars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">variances_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">normalize</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">varlabels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">varlabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Var &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvariances</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">connected</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata_</span><span class="p">,</span> <span class="n">ydata_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                   <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean prediction&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvariances</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">varcolors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">varcolor</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="n">ii</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">/</span> <span class="n">nvariances</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">varcolor</span> <span class="o">=</span> <span class="n">varcolors</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xdata_</span><span class="p">,</span>
                               <span class="n">ydata_</span> <span class="o">-</span> <span class="n">stdfactor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cvars</span><span class="p">[:,</span> <span class="n">ii</span><span class="p">]),</span>
                               <span class="n">ydata_</span> <span class="o">+</span> <span class="n">stdfactor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cvars</span><span class="p">[:,</span> <span class="n">ii</span><span class="p">]),</span>
                               <span class="n">color</span><span class="o">=</span><span class="n">varcolor</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">varlabels</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1000</span> <span class="o">-</span> <span class="n">ii</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata_</span><span class="p">,</span> <span class="n">ydata_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                   <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean prediction&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvariances</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">varcolors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">varcolor</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="n">ii</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">/</span> <span class="n">nvariances</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">varcolor</span> <span class="o">=</span> <span class="n">varcolors</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xdata_</span><span class="p">,</span> <span class="n">ydata_</span><span class="p">,</span>
                           <span class="n">yerr</span><span class="o">=</span><span class="n">stdfactor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cvars</span><span class="p">[:,</span> <span class="n">ii</span><span class="p">]),</span>
                           <span class="n">color</span><span class="o">=</span><span class="n">varcolor</span><span class="p">,</span>
                           <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="n">varlabels</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10000</span> <span class="o">-</span> <span class="n">ii</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid_show</span><span class="p">)</span></div>



<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_shade">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_shade">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_shade</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">nq</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">BuGn</span><span class="p">,</span>
               <span class="n">bounds_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">grid_show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting quantile-shaded predictions given dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        xdata (np.ndarray): Input values, an 1d array of size `(N,)`.</span>
<span class="sd">        ydata (np.ndarray): Output values, a 2d array of size `(N,M)`.</span>
<span class="sd">        nq (int, optional): Number of quantiles.</span>
<span class="sd">        cmap (mpl.Cm, optional): Colormap. Defaults to BuGn.</span>
<span class="sd">        bounds_show (bool, optional): Whether to highlight the bounds.</span>
<span class="sd">        grid_show (bool, optional): Whether to show the grid or not.</span>
<span class="sd">        ax (plt.Axes, optional): Axis handle. If None, use the current axis.</span>
<span class="sd">    Note:</span>
<span class="sd">        ax is changed as a result of this function. Further beautification and figure saving should be done outside this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="n">nx</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">nx</span> <span class="o">==</span> <span class="n">ydata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">mq</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">mstats</span><span class="o">.</span><span class="n">mquantiles</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">nq</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nq</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">normalize</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nq</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">mq</span><span class="p">[:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">mq</span><span class="p">[:,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                         <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="mf">0.01</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="mf">.02</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nq</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nq</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">mq</span><span class="p">[:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">mq</span><span class="p">[:,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                         <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="n">nq</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.02</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">bounds_show</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">mq</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">mq</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid_show</span><span class="p">)</span></div>



<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_1d_anchored_single">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_1d_anchored_single">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_1d_anchored_single</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">modelpars</span><span class="p">,</span>
                            <span class="n">anchor1</span><span class="p">,</span> <span class="n">anchor2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">ngr</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span>
                            <span class="n">modellabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clearax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">verbose_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">legend_show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots 1d slices of a list of models going through one or two anchor points.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (list[callable]): List of model evaluators.</span>
<span class="sd">        modelpars (list[tuple]): List of model parameter tuples, one for each.</span>
<span class="sd">        anchor1 (np.ndarray): 1d array of the first anchor point.</span>
<span class="sd">        anchor2 (np.ndarray, optional): 1d array of the second anchor point. Defaults to None, which means a randomly selected second anchor a given distance away from the first.</span>
<span class="sd">        pad (float, optional): Padding on both sides of the interval, so the slice goes beyond the anchors.</span>
<span class="sd">        scale (float, optional): The distance of the second anchor from the first, if randomly selected.</span>
<span class="sd">        ngr (int, optional): Number of grid points for plotting.</span>
<span class="sd">        modellabels (None, optional): Labels/names of the models for legend.</span>
<span class="sd">        clearax (bool, optional): Clear axes ticks and labels for less busy plotting.</span>
<span class="sd">        verbose_labels (bool, optional): Optionally, annotates the points showing their coordinates. Makes sense for low-dim cases.</span>
<span class="sd">        legend_show (bool, optional): Whether to show the legend or not.</span>
<span class="sd">        ax (None, optional): Axis handle. Default to None, i.e. current axis.</span>
<span class="sd">        figname (None, optional): Optionally, save to a figure with a given name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">modellabels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modellabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Model </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">))]</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">anchor2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">anchor2</span> <span class="o">=</span> <span class="n">sample_sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">anchor1</span><span class="p">,</span> <span class="n">rad</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">nsam</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>
        <span class="n">origin</span><span class="p">,</span> <span class="n">e1</span> <span class="o">=</span> <span class="n">anchor1</span><span class="p">,</span> <span class="n">anchor2</span><span class="o">-</span><span class="n">anchor1</span>
        <span class="n">ticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;A$-\Delta$&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;A$+\Delta$&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">origin</span><span class="p">,</span> <span class="n">e1</span> <span class="o">=</span> <span class="p">(</span><span class="n">anchor1</span><span class="o">+</span><span class="n">anchor2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="p">(</span><span class="n">anchor2</span><span class="o">-</span><span class="n">anchor1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
        <span class="n">ticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;A$_1$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;A$_2$&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">verbose_labels</span><span class="p">:</span>
        <span class="n">ticklabels2</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">strarr</span><span class="p">(</span><span class="n">origin</span><span class="o">-</span><span class="n">e1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">strarr</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">strarr</span><span class="p">(</span><span class="n">origin</span><span class="o">+</span><span class="n">e1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
        <span class="n">ticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ticklabels</span><span class="p">,</span> <span class="n">ticklabels2</span><span class="p">)]</span>

    <span class="n">tgr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">-</span><span class="n">pad</span><span class="p">,</span> <span class="mf">1.</span><span class="o">+</span><span class="n">pad</span><span class="p">,</span> <span class="n">ngr</span><span class="p">)</span>

    <span class="n">xgr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">origin</span> <span class="o">+</span> <span class="n">e1</span><span class="o">*</span><span class="n">tt</span> <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">tgr</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">modelpar</span><span class="p">,</span> <span class="n">modellabel</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">modelpars</span><span class="p">,</span> <span class="n">modellabels</span><span class="p">):</span>
        <span class="n">ygr</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">xgr</span><span class="p">,</span> <span class="n">modelpar</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tgr</span><span class="p">,</span> <span class="n">ygr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">modellabel</span><span class="p">)</span>


    <span class="c1">#plt.annotate(&#39;Something&#39;, (-1,0))</span>


    <span class="k">if</span> <span class="n">clearax</span><span class="p">:</span>
        <span class="c1">#ax.set_frame_on(False)</span>
        <span class="c1">#ax.get_yaxis().set_visible(False)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># xmin, xmax = ax.get_xaxis().get_view_interval()</span>
        <span class="c1"># ymin, ymax = ax.get_yaxis().get_view_interval()</span>
        <span class="c1"># ax.add_artist(plt.Line2D((xmin, xmax), (ymin, ymin), color=&#39;black&#39;, linewidth=2))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">ticklabels</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legend_show</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">figname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_1d_anchored">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_1d_anchored">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_1d_anchored</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">modelpars</span><span class="p">,</span>
                     <span class="n">anchor1</span><span class="p">,</span>
                     <span class="n">pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">ngr</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span>
                     <span class="n">modellabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">clearax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">ncolrow</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot multiple 1d slices of models all going through a given anchor point.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (list[callable]): List of model evaluators.</span>
<span class="sd">        modelpars (list[tuple]): List of model parameter tuples, one for each.</span>
<span class="sd">        anchor1 (np.ndarray): The anchor point, 1d array.</span>
<span class="sd">        pad (float, optional): Padding on both sides of the interval, so the slice goes beyond the anchors.</span>
<span class="sd">        scale (float, optional): The distance of the second anchor from the first, if randomly selected.</span>
<span class="sd">        ngr (int, optional): Number of grid points for plotting.</span>
<span class="sd">        modellabels (None, optional): Labels/names of the models for legend.</span>
<span class="sd">        legend_show (bool, optional): Whether to show the legend or not.</span>
<span class="sd">        clearax (bool, optional): Clear axes ticks and labels for less busy plotting.</span>
<span class="sd">        verbose_labels (bool, optional): Optionally, annotates the points showing their coordinates. Makes sense for low-dim cases.</span>
<span class="sd">        ncolrow (tuple, optional): Number of columns and rows in a tuple. Defaults to (3, 5).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ncol</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="n">ncolrow</span>
    <span class="n">ntot</span> <span class="o">=</span> <span class="n">ncol</span> <span class="o">*</span> <span class="n">nrow</span>


    <span class="n">figs</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncol</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">nrow</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ntot</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="n">axarr</span><span class="o">=</span><span class="p">[[</span><span class="n">axarr</span><span class="p">]]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntot</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting slice </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">ntot</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">irow</span><span class="p">,</span> <span class="n">icol</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ncol</span><span class="p">)</span>

        <span class="n">thisax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">icol</span><span class="p">]</span>

        <span class="n">plot_1d_anchored_single</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">modelpars</span><span class="p">,</span> <span class="n">anchor1</span><span class="p">,</span> <span class="n">anchor2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">ngr</span><span class="o">=</span><span class="n">ngr</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
                     <span class="n">modellabels</span><span class="o">=</span><span class="n">modellabels</span><span class="p">,</span> <span class="n">clearax</span><span class="o">=</span><span class="n">clearax</span><span class="p">,</span>
                     <span class="n">verbose_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">ax</span><span class="o">=</span><span class="n">thisax</span><span class="p">,</span> <span class="n">figname</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">legend_show</span><span class="p">:</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span>
                         <span class="n">ncol</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fcn_1dslices.png&#39;</span><span class="p">)</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_2d_anchored_single">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_2d_anchored_single">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_2d_anchored_single</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">modelpars</span><span class="p">,</span>
                            <span class="n">anchor1</span><span class="p">,</span> <span class="n">anchor2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anchor3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">squished</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">ngr</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span>
                            <span class="n">modellabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorful</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clearax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">legend_show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modelcolors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots 2d slices of a list of models going through one or two anchor points.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (list[callable]): List of model evaluators.</span>
<span class="sd">        modelpars (list[tuple]): List of model parameter tuples, one for each.</span>
<span class="sd">        anchor1 (np.ndarray): 1d array of the first anchor point.</span>
<span class="sd">        anchor2 (np.ndarray, optional): 1d array of the second anchor point. Defaults to None, which means a randomly selected second anchor a given distance away from the first.</span>
<span class="sd">        anchor3 (np.ndarray, optional): 1d array of the third anchor point. Defaults to None, which means a randomly selected second anchor a given distance away from the first.</span>
<span class="sd">        squished (bool, optional): If squished, the bases in the plane are not orthogonal.</span>
<span class="sd">        pad (float, optional): Padding on both sides of the domain, so the slice goes beyond the anchors.</span>
<span class="sd">        scale (float, optional): The distance of the second anchor from the first, if randomly selected.</span>
<span class="sd">        ngr (int, optional): Number of grid points for plotting.</span>
<span class="sd">        modellabels (None, optional): Labels/names of the models for legend.</span>
<span class="sd">        colorful (bool, optional): Whether printing with colored surface or simply contours.</span>
<span class="sd">        clearax (bool, optional): Clear axes ticks and labels for less busy plotting.</span>
<span class="sd">        legend_show (bool, optional): Whether to show the legend or not.</span>
<span class="sd">        modelcolors (list, optional): List of model colors.</span>
<span class="sd">        ax (None, optional): Axis handle. Default to None, i.e. current axis.</span>
<span class="sd">        figname (None, optional): Optionally, save to a figure with a given name.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: need to make this cyclic and remove the assertion</span>
    <span class="k">if</span> <span class="n">modelcolors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modelcolors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">modellabels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modellabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Model </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">))]</span>


    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">anchor2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">anchor2</span> <span class="o">=</span> <span class="n">sample_sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">anchor1</span><span class="p">,</span> <span class="n">rad</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">nsam</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>
    <span class="k">if</span> <span class="n">anchor3</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">anchor3</span> <span class="o">=</span> <span class="n">sample_sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">anchor1</span><span class="p">,</span> <span class="n">rad</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">nsam</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>

    <span class="k">if</span> <span class="n">squished</span><span class="p">:</span>
        <span class="n">origin</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">anchor1</span><span class="p">,</span> <span class="n">anchor2</span><span class="o">-</span><span class="n">anchor1</span><span class="p">,</span> <span class="n">anchor3</span><span class="o">-</span><span class="n">anchor1</span>
            <span class="c1"># ticklabelsx = [f&quot;A$_x-\Delta_x$&quot;, f&#39;A$_x$&#39;, f&#39;A$_x+\Delta_x$&#39;]</span>
            <span class="c1"># ticklabelsy = [f&quot;A$_y-\Delta_y$&quot;, f&#39;A$_y$&#39;, f&#39;A$_y+\Delta_y$&#39;]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">anchor1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">anchor2</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">anchor3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">origin</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">pick_basis</span><span class="p">(</span><span class="n">anchor1</span><span class="p">,</span> <span class="n">anchor2</span><span class="p">,</span> <span class="n">anchor3</span><span class="p">)</span>


    <span class="n">ticklabelsx</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ticklabelsy</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="n">tgr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">-</span><span class="n">pad</span><span class="p">,</span> <span class="mf">1.</span><span class="o">+</span><span class="n">pad</span><span class="p">,</span> <span class="n">ngr</span><span class="p">)</span>

    <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">tgr</span><span class="p">,</span> <span class="n">tgr</span><span class="p">)</span>
    <span class="n">tgr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">tx</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">ty</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span><span class="o">.</span><span class="n">T</span> <span class="c1">#np.dstack((xp, yp))</span>
    <span class="n">xgr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">origin</span> <span class="o">+</span> <span class="n">e1</span><span class="o">*</span><span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">e2</span><span class="o">*</span><span class="n">tt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">tgr2</span><span class="p">])</span>

    <span class="n">j</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">modelpar</span><span class="p">,</span> <span class="n">modellabel</span><span class="p">,</span> <span class="n">modelcolor</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">modelpars</span><span class="p">,</span> <span class="n">modellabels</span><span class="p">,</span> <span class="n">modelcolors</span><span class="p">):</span>
        <span class="n">zgr</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">xgr</span><span class="p">,</span> <span class="n">modelpar</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">colorful</span><span class="p">:</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">zgr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="mi">22</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn_r&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">modelcolor</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">zgr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">levels</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">modelcolor</span><span class="p">)</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>


    <span class="c1"># ax.plot([0], [0], &#39;ko&#39;)</span>
    <span class="c1"># plt.annotate(&#39;Something&#39;, (-1,0))</span>


    <span class="k">if</span> <span class="n">clearax</span><span class="p">:</span>
        <span class="c1">#ax.set_frame_on(False)</span>
        <span class="c1">#ax.get_yaxis().set_visible(False)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># xmin, xmax = ax.get_xaxis().get_view_interval()</span>
        <span class="c1"># ymin, ymax = ax.get_yaxis().get_view_interval()</span>
        <span class="c1"># thisax.add_artist(plt.Line2D((xmin, xmax), (ymin, ymin), color=&#39;black&#39;, linewidth=2))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">ticklabelsx</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">ticklabelsy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">legend_show</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">figname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_2d_anchored">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_2d_anchored">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_2d_anchored</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">modelpars</span><span class="p">,</span> <span class="n">anchor1</span><span class="p">,</span> <span class="n">anchor2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">ngr</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span>
                  <span class="n">modellabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">squished</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colorful</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">legend_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">modelcolors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">clearax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ncolrow</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot multiple 1d slices of models all going through a given anchor point or given two anchor points.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (list[callable]): List of model evaluators.</span>
<span class="sd">        modelpars (list[tuple]): List of model parameter tuples, one for each.</span>
<span class="sd">        anchor1 (np.ndarray): The first anchor point, 1d array.</span>
<span class="sd">        anchor2 (np.ndarray, optional): The second anchor point. Defaults to None, in which case it is selected randomly.</span>
<span class="sd">        pad (float, optional): Padding on both sides of the interval, so the slice goes beyond the anchors.</span>
<span class="sd">        scale (float, optional): The distance of the second anchor from the first, if randomly selected.</span>
<span class="sd">        ngr (int, optional): Number of grid points for plotting.</span>
<span class="sd">        modellabels (None, optional): Labels/names of the models for legend.</span>
<span class="sd">        squished (bool, optional): If squished, the bases in the plane are not orthogonal.</span>
<span class="sd">        colorful (bool, optional): Whether printing with colored surface or simply contours.</span>
<span class="sd">        legend_show (bool, optional): Whether to show the legend or not.</span>
<span class="sd">        modelcolors (list, optional): List of model colors.</span>
<span class="sd">        clearax (bool, optional): Clear axes ticks and labels for less busy plotting.</span>
<span class="sd">        ncolrow (tuple, optional): Number of columns and rows in a tuple. Defaults to (3, 5).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: need to make this cyclic and remove the assertion</span>
    <span class="k">if</span> <span class="n">modelcolors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modelcolors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">)</span>

    <span class="n">ncol</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="n">ncolrow</span>
    <span class="n">ntot</span> <span class="o">=</span> <span class="n">ncol</span> <span class="o">*</span> <span class="n">nrow</span>


    <span class="n">figs</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncol</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">nrow</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ntot</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="n">axarr</span><span class="o">=</span><span class="p">[[</span><span class="n">axarr</span><span class="p">]]</span>

    <span class="k">if</span> <span class="n">anchor2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">anchor2</span> <span class="o">=</span> <span class="n">sample_sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">anchor1</span><span class="p">,</span> <span class="n">rad</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">nsam</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntot</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting slice </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">ntot</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">irow</span><span class="p">,</span> <span class="n">icol</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ncol</span><span class="p">)</span>

        <span class="n">thisax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">icol</span><span class="p">]</span>

        <span class="n">plot_2d_anchored_single</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">modelpars</span><span class="p">,</span> <span class="n">anchor1</span><span class="p">,</span> <span class="n">anchor2</span><span class="o">=</span><span class="n">anchor2</span><span class="p">,</span>
                     <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">ngr</span><span class="o">=</span><span class="n">ngr</span><span class="p">,</span> <span class="n">squished</span><span class="o">=</span><span class="n">squished</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
                     <span class="n">modellabels</span><span class="o">=</span><span class="n">modellabels</span><span class="p">,</span> <span class="n">modelcolors</span><span class="o">=</span><span class="n">modelcolors</span><span class="p">,</span>
                     <span class="n">clearax</span><span class="o">=</span><span class="n">clearax</span><span class="p">,</span> <span class="n">colorful</span><span class="o">=</span><span class="n">colorful</span><span class="p">,</span>
                     <span class="n">legend_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">ax</span><span class="o">=</span><span class="n">thisax</span><span class="p">,</span> <span class="n">figname</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">legend_show</span><span class="p">:</span>
        <span class="n">custom_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">cc</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">modelcolors</span><span class="p">]</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">custom_lines</span><span class="p">,</span> <span class="n">modellabels</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.3</span><span class="p">),</span>
                         <span class="n">ncol</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fcn_2dslices.png&#39;</span><span class="p">)</span></div>


<span class="c1">#############################################################</span>

<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_fcn_1d_slice">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_fcn_1d_slice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_fcn_1d_slice</span><span class="p">(</span><span class="n">fcn</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">idim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ngr</span><span class="o">=</span><span class="mi">133</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting 1d slice of a function, keeping the rest of the inputs at a given nominal.</span>

<span class="sd">    Args:</span>
<span class="sd">        fcn (callable): Function evaluator.</span>
<span class="sd">        domain (np.ndarray): Domain of evaluation, a 2d array of size `(d, 2)`.</span>
<span class="sd">        idim (int, optional): Dimension, with respect to which the slice is plotted.</span>
<span class="sd">        nom (None, optional): Nominal values, an 1d array of size `(d,)`.</span>
<span class="sd">        ngr (int, optional): Number of grid points, i.e. resolution.</span>
<span class="sd">        color (str, optional): Color of the plot.</span>
<span class="sd">        lw (int, optional): Line width.</span>
<span class="sd">        ax (plt.Axes, optional): Axis handle. If None, use the current axis.</span>
<span class="sd">    Note:</span>
<span class="sd">        ax is changed as a result of this function. Further beautification and figure saving should be done outside this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">nom</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">xg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">domain</span><span class="p">[</span><span class="n">idim</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">domain</span><span class="p">[</span><span class="n">idim</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ngr</span><span class="p">)</span>
    <span class="n">xg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">nom</span><span class="p">,</span> <span class="p">(</span><span class="n">ngr</span><span class="o">*</span><span class="n">ngr</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">xg</span><span class="p">[:,</span> <span class="n">idim</span><span class="p">]</span> <span class="o">=</span> <span class="n">xg1</span>

    <span class="n">yg</span> <span class="o">=</span> <span class="n">fcn</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg1</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span></div>



<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_fcn_2d_slice">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_fcn_2d_slice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_fcn_2d_slice</span><span class="p">(</span><span class="n">fcn</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">idim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">jdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ngr</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting 2d slice of a function, keeping the rest of the inputs at a given nominal.</span>

<span class="sd">    Args:</span>
<span class="sd">        fcn (callable): Function evaluator.</span>
<span class="sd">        domain (np.ndarray): Domain of evaluation, a 2d array of size `(d, 2)`.</span>
<span class="sd">        idim (int, optional): First dimension, with respect to which the slice is plotted.</span>
<span class="sd">        jdim (int, optional): Second dimension, with respect to which the slice is plotted.</span>
<span class="sd">        nom (None, optional): Nominal values, an 1d array of size `(d,)`.</span>
<span class="sd">        ngr (int, optional): Number of grid points per dimension, i.e. resolution.</span>
<span class="sd">        color (str, optional): Color of the plot.</span>
<span class="sd">        ax (plt.Axes, optional): Axis handle. If None, use the current axis.</span>
<span class="sd">    Note:</span>
<span class="sd">        ax is changed as a result of this function. Further beautification and figure saving should be done outside this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">nom</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">xg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">domain</span><span class="p">[</span><span class="n">idim</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">domain</span><span class="p">[</span><span class="n">idim</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ngr</span><span class="p">)</span>
    <span class="n">xg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">domain</span><span class="p">[</span><span class="n">jdim</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">domain</span><span class="p">[</span><span class="n">jdim</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ngr</span><span class="p">)</span>

    <span class="n">xg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">nom</span><span class="p">,</span> <span class="p">(</span><span class="n">ngr</span><span class="o">*</span><span class="n">ngr</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xg1</span><span class="p">,</span> <span class="n">xg2</span><span class="p">)</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">Y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># xx.shape is (ngr^2,2)</span>

    <span class="n">xg</span><span class="p">[:,</span> <span class="n">idim</span><span class="p">]</span> <span class="o">=</span> <span class="n">xx</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">xg</span><span class="p">[:,</span> <span class="n">jdim</span><span class="p">]</span> <span class="o">=</span> <span class="n">xx</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">yg</span> <span class="o">=</span> <span class="n">fcn</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn_r&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span></div>



<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_uc_sample">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_uc_sample">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_uc_sample</span><span class="p">(</span><span class="n">pred_sam</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">nqt</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting uncertainty calibration figure given samples.</span>

<span class="sd">    Args:</span>
<span class="sd">        pred_sam (np.ndarray): Samples, in a 2d array of size `(M,N)`.</span>
<span class="sd">        data (np.ndarray): Data, in a 1d array of size `(N,)`.</span>
<span class="sd">        nqt (int, optional): Number of quantiles used. Essentially, the resolution.</span>
<span class="sd">        label (str, optional): Custom label.</span>
<span class="sd">        ax (plt.Axes, optional): Axis handle. If None, use the current axis.</span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple: Data fractions and quantile values corresponding to these fractions.</span>
<span class="sd">    Note:</span>
<span class="sd">        ax is changed as a result of this function. Further beautification and figure saving should be done outside this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nsam</span><span class="p">,</span> <span class="n">nx_</span> <span class="o">=</span> <span class="n">pred_sam</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">nx</span><span class="o">==</span><span class="n">nx_</span><span class="p">)</span>
    <span class="n">qq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">nqt</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pred_qt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">pred_sam</span><span class="p">,</span> <span class="n">qq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">frac_qq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">qq</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nqt</span><span class="p">):</span>
        <span class="n">frac_qq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">data</span><span class="o">&lt;</span><span class="n">pred_qt</span><span class="p">[</span><span class="n">i</span><span class="p">,:]]))</span><span class="o">/</span><span class="n">nx</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">qq</span><span class="p">,</span> <span class="n">frac_qq</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Prediction Quantile&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Data Fraction&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;uc_sample.png&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">qq</span><span class="p">,</span> <span class="n">frac_qq</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">frac_qq</span><span class="p">,</span> <span class="n">qq</span></div>


<span class="c1">#############################################################</span>

<div class="viewcode-block" id="plot_uc_exact">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_uc_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_uc_exact</span><span class="p">(</span><span class="n">pred_mean</span><span class="p">,</span> <span class="n">pred_std</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">nqt</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting uncertainty calibration figure given mean and standard deviation of predictions.</span>

<span class="sd">    Args:</span>
<span class="sd">        pred_mean (np.ndarray): Prediction mean, in a 1d array of size `(N,)`.</span>
<span class="sd">        pred_std (np.ndarray): Prediction standard deviation, in a 1d array of size `(N,)`.</span>
<span class="sd">        data (np.ndarray): Data, in a 1d array of size `(N,)`.</span>
<span class="sd">        nqt (int, optional): Number of quantiles used. Essentially, the resolution.</span>
<span class="sd">        label (str, optional): Custom label.</span>
<span class="sd">        ax (plt.Axes, optional): Axis handle. If None, use the current axis.</span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple: Data fractions and quantile values corresponding to these fractions.</span>
<span class="sd">    Note:</span>
<span class="sd">        ax is changed as a result of this function. Further beautification and figure saving should be done outside this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="n">pred_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">nx_</span> <span class="o">=</span> <span class="n">pred_std</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">nx</span><span class="o">==</span><span class="n">nx_</span><span class="p">)</span>
    <span class="n">qq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">nqt</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">pred_qt_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nqt</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nqt</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span>
            <span class="n">pred_qt_exact</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">qq</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="n">pred_mean</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">pred_std</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="n">frac_qq_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">qq</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nqt</span><span class="p">):</span>
        <span class="n">frac_qq_exact</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">data</span><span class="o">&lt;</span><span class="n">pred_qt_exact</span><span class="p">[</span><span class="n">i</span><span class="p">,:]]))</span><span class="o">/</span><span class="n">nx</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">qq</span><span class="p">,</span> <span class="n">frac_qq_exact</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Prediction Quantile&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Data Fraction&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;uc_exact.png&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">qq</span><span class="p">,</span> <span class="n">frac_qq_exact</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">frac_qq_exact</span><span class="p">,</span> <span class="n">qq</span></div>



<div class="viewcode-block" id="plot_samples_pdfs">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_samples_pdfs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_samples_pdfs</span><span class="p">(</span><span class="n">xx_list</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots multiple pdfs given list of samples</span>

<span class="sd">    Args:</span>
<span class="sd">        xx_list (list[np.ndarray]): List of samples.</span>
<span class="sd">        legends (list[str], optional): List of legends. Defaults to generic text.</span>
<span class="sd">        colors (list[str], optional): List of colors. Defaults to generic color cycle.</span>
<span class="sd">        file_prefix (str, optional): Figure file prefix.</span>
<span class="sd">        title (str, optional): Figure title. Default is no title.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">npdfs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xx_list</span><span class="p">)</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="n">xx_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">npdfs</span> <span class="c1">#overkill</span>
    <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Data #&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npdfs</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">idim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
        <span class="n">ff</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npdfs</span><span class="p">):</span>
            <span class="n">plot_pdf1d</span><span class="p">(</span><span class="n">xx_list</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span> <span class="n">idim</span><span class="p">],</span> <span class="n">pltype</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">legends</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
        <span class="n">h</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x$_</span><span class="si">{</span><span class="n">idim</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_prefix</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;_d</span><span class="si">{</span><span class="n">idim</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">jdim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">idim</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="p">):</span>
            <span class="n">ff</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npdfs</span><span class="p">):</span>
                <span class="n">plot_pdf2d</span><span class="p">(</span><span class="n">xx_list</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span> <span class="n">idim</span><span class="p">],</span> <span class="n">xx_list</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span> <span class="n">jdim</span><span class="p">],</span> <span class="n">pltype</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="n">ncont</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x$_</span><span class="si">{</span><span class="n">idim</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x$_</span><span class="si">{</span><span class="n">jdim</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_prefix</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;_d</span><span class="si">{</span><span class="n">idim</span><span class="si">}</span><span class="s1">_d</span><span class="si">{</span><span class="n">jdim</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="k">return</span></div>


<div class="viewcode-block" id="plot_1d">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_1d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_1d</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">odim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ngr</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">lstyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">figname</span><span class="o">=</span><span class="s1">&#39;func1d.png&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting 1d slice of a function.</span>

<span class="sd">    Args:</span>
<span class="sd">        func (callable): The callable function of interest.</span>
<span class="sd">        domain (np.ndarray): A dx2 array indicating the domain of the function.</span>
<span class="sd">        ax (None, optional): Axis object to plot on. If None, plots on current axis.</span>
<span class="sd">        idim (int, optional): Input dimension to plot against.</span>
<span class="sd">        odim (int, optional): Output QoI to plot against. Useful for multioutput funtions.</span>
<span class="sd">        nom (np.ndarray, optional): Nominal value to fix non-plotted dimensions at. An array of size d. If None, uses the domain center.</span>
<span class="sd">        ngr (int, optional): Number of grid points.</span>
<span class="sd">        color (str, optional): Color of the graph.</span>
<span class="sd">        lstyle (str, optional): Linestyle of the graph.</span>
<span class="sd">        figname (str, optional): Figure name to save.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">nom</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">xg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">domain</span><span class="p">[</span><span class="n">idim</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">domain</span><span class="p">[</span><span class="n">idim</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ngr</span><span class="p">)</span>

    <span class="n">xg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">nom</span><span class="p">,</span> <span class="p">(</span><span class="n">ngr</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


    <span class="n">xg</span><span class="p">[:,</span> <span class="n">idim</span><span class="p">]</span> <span class="o">=</span> <span class="n">xg1</span>
    <span class="n">yg</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xg</span><span class="p">)[:,</span> <span class="n">odim</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">[:,</span> <span class="n">idim</span><span class="p">],</span> <span class="n">yg</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">lstyle</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>

    <span class="k">return</span></div>


<div class="viewcode-block" id="plot_2d">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_2d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_2d</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">jdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">odim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ngr</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">figname</span><span class="o">=</span><span class="s1">&#39;func2d.png&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotting 2d slice of a function.</span>

<span class="sd">    Args:</span>
<span class="sd">        func (callable): The callable function of interest.</span>
<span class="sd">        domain (np.ndarray): A dx2 array indicating the domain of the function.</span>
<span class="sd">        ax (None, optional): Axis object to plot on. If None, plots on current axis.</span>
<span class="sd">        idim (int, optional): First input dimension to plot against.</span>
<span class="sd">        jdim (int, optional): Second input dimension to plot against.</span>
<span class="sd">        odim (int, optional): Output QoI to plot against. Useful for multioutput funtions.</span>
<span class="sd">        nom (np.ndarray, optional): Nominal value to fix non-plotted dimensions at. An array of size d. If None, uses the domain center.</span>
<span class="sd">        ngr (int, optional): Number of grid points.</span>
<span class="sd">        figname (str, optional): Figure name to save.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">nom</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">xg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">domain</span><span class="p">[</span><span class="n">idim</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">domain</span><span class="p">[</span><span class="n">idim</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ngr</span><span class="p">)</span>
    <span class="n">xg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">domain</span><span class="p">[</span><span class="n">jdim</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">domain</span><span class="p">[</span><span class="n">jdim</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ngr</span><span class="p">)</span>

    <span class="n">xg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">nom</span><span class="p">,</span> <span class="p">(</span><span class="n">ngr</span><span class="o">*</span><span class="n">ngr</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xg1</span><span class="p">,</span> <span class="n">xg2</span><span class="p">)</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">Y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># xx.shape is (ngr^2,2)</span>

    <span class="n">xg</span><span class="p">[:,</span> <span class="n">idim</span><span class="p">]</span> <span class="o">=</span> <span class="n">xx</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">xg</span><span class="p">[:,</span> <span class="n">jdim</span><span class="p">]</span> <span class="o">=</span> <span class="n">xx</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">yg</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xg</span><span class="p">)[:,</span> <span class="n">odim</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn_r&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>

    <span class="k">return</span></div>


<span class="c1">########################################################################</span>

<div class="viewcode-block" id="plot_parity">
<a class="viewcode-back" href="../../../autoapi/pytuq/utils/plotting/index.html#pytuq.utils.plotting.plot_parity">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_parity</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">,</span> <span class="s1">&#39;y2&#39;</span><span class="p">],</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;parity.png&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A minimal parity plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        y1 (np.ndarray): The 1d array on the x-axis.</span>
<span class="sd">        y2 (np.ndarray): The 1d array on the y-axis.</span>
<span class="sd">        labels (list, optional): List of length two for the axes labels.</span>
<span class="sd">        filename (str, optional): Figure filename to save.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">llim</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y2</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">ulim</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y2</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">delt</span> <span class="o">=</span> <span class="n">ulim</span> <span class="o">-</span> <span class="n">llim</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">llim</span><span class="o">-</span><span class="mf">0.1</span><span class="o">*</span><span class="n">delt</span><span class="p">,</span> <span class="n">ulim</span><span class="o">+</span><span class="mf">0.1</span><span class="o">*</span><span class="n">delt</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="n">llim</span><span class="o">-</span><span class="mf">0.1</span><span class="o">*</span><span class="n">delt</span><span class="p">,</span> <span class="n">ulim</span><span class="o">+</span><span class="mf">0.1</span><span class="o">*</span><span class="n">delt</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">llim</span><span class="p">,</span> <span class="n">ulim</span><span class="p">],</span> <span class="p">[</span><span class="n">llim</span><span class="p">,</span> <span class="n">ulim</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Bert Debusschere, Khachik Sargsyan, Emilie Baillo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>